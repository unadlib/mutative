"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8589],{7381:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var n=i(5893),s=i(1151);const a={sidebar_position:7},r="Strict Mode",o={id:"advanced-guides/strict-mode",title:"Strict Mode",description:"Strict mode in Mutative is a feature designed to reinforce the library\u2019s immutability guarantees by ensuring that state mutations adhere to the principles of immutable update patterns.",source:"@site/docs/advanced-guides/strict-mode.md",sourceDirName:"advanced-guides",slug:"/advanced-guides/strict-mode",permalink:"/docs/advanced-guides/strict-mode",draft:!1,unlisted:!1,editUrl:"https://github.com/unadlib/mutative/tree/main/website/docs/advanced-guides/strict-mode.md",tags:[],version:"current",lastUpdatedBy:"unadlib",lastUpdatedAt:170222723e4,sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"Auto Freeze",permalink:"/docs/advanced-guides/auto-freeze"},next:{title:"Typescript",permalink:"/docs/advanced-guides/typescript"}},d={},c=[{value:"Strict mode options",id:"strict-mode-options",level:2},{value:"Enable strict mode",id:"enable-strict-mode",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"strict-mode",children:"Strict Mode"}),"\n",(0,n.jsx)(t.p,{children:"Strict mode in Mutative is a feature designed to reinforce the library\u2019s immutability guarantees by ensuring that state mutations adhere to the principles of immutable update patterns."}),"\n",(0,n.jsx)(t.h2,{id:"strict-mode-options",children:"Strict mode options"}),"\n",(0,n.jsxs)(t.p,{children:["strict option is ",(0,n.jsx)(t.code,{children:"boolean"})," type, the default is ",(0,n.jsx)(t.code,{children:"false"}),"."]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Forbid accessing non-draftable values in strict mode(unless using ",(0,n.jsx)(t.a,{href:"/docs/api-reference/unsafe",children:"unsafe()"}),")."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["When strict mode is enabled, mutable data can only be accessed using ",(0,n.jsx)(t.a,{href:"/docs/api-reference/unsafe",children:(0,n.jsx)(t.code,{children:"unsafe()"})}),"."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.admonition,{type:"tip",children:[(0,n.jsxs)(t.p,{children:[(0,n.jsxs)(t.strong,{children:["It is recommended to enable ",(0,n.jsx)(t.code,{children:"strict"})," in development mode and disable ",(0,n.jsx)(t.code,{children:"strict"})," in production mode."]})," This will ensure safe explicit returns and also keep good performance in the production build. If the value that does not mix any current draft or is ",(0,n.jsx)(t.code,{children:"undefined"})," is returned, then use ",(0,n.jsx)(t.a,{href:"/docs/api-reference/rawreturn",children:"rawReturn()"}),"."]}),(0,n.jsxs)(t.p,{children:["If you'd like to enable strict mode by default in a development build and turn it off for production, you can use ",(0,n.jsx)(t.code,{children:"strict: process.env.NODE_ENV !== 'production'"}),"."]})]}),"\n",(0,n.jsx)(t.h2,{id:"enable-strict-mode",children:"Enable strict mode"}),"\n",(0,n.jsx)(t.p,{children:"Mutative's strict mode is a safeguard that developers can activate to enforce immutable state updates, thereby maintaining the integrity and predictability of state transitions. When strict mode is enabled, any attempt to directly modify the original state within a draft will throw an error, serving as an immediate alert to the developer that an immutable update rule has been violated. This helps catch potentially harmful mutations during development, allowing developers to address issues before they impact the application's stability."}),"\n",(0,n.jsx)(t.p,{children:"Key characteristics of strict mode include:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Enforcing immutability"}),": By preventing direct state mutations, strict mode ensures that changes to the application state are made without side effects, preserving the original state until an explicit update is committed."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Debugging aid"}),": It acts as a development aid by providing immediate feedback on improper state mutations, thus helping to identify and rectify bugs early in the development process."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Compatibility with advanced operations"}),": Even in strict mode, Mutative provides APIs like ",(0,n.jsx)(t.a,{href:"/docs/api-reference/unsafe",children:(0,n.jsx)(t.code,{children:"unsafe()"})})," and ",(0,n.jsx)(t.a,{href:"/docs/api-reference/rawreturn",children:(0,n.jsx)(t.code,{children:"rawReturn()"})})," that allow developers to explicitly bypass immutability checks when necessary. These APIs must be used with a clear understanding of their implications to ensure they do not compromise the application\u2019s state integrity."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Strict mode is indicative of Mutative's commitment to offering robust, error-resistant state management. It is a testament to the library's philosophy of providing tools that encourage best practices while still offering the flexibility to handle advanced state manipulation scenarios when needed. As such, strict mode is an invaluable feature for developers aiming to build applications with a solid foundation in immutable state management principles."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"class Foobar {\n  bar = 1;\n}\n\nconst foobar = new Foobar();\nconst foobar0 = new Foobar();\nconst data = {\n  foo: {\n    bar: 'str',\n  },\n  foobar,\n  foobar0,\n};\n\nconst state = create(\n  data,\n  (draft) => {\n    unsafe(() => {\n      draft.foobar.bar = 2;\n    });\n    // it will throw an error in strict mode\n    draft.foobar0.bar = 3;\n  },\n  {\n    strict: true,\n  }\n);\n"})})]})}function u(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>o,a:()=>r});var n=i(7294);const s={},a=n.createContext(s);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);